//
//  NewsFeedVM.swift
//  Vidhik
//
//  Created by Dinesh Rajput on 13/05/24.
//

import Foundation

class NewsFeedVM {
    var newsArray: [NewsDataModel] = []
}

// MARK: =========== News List API Calling =================
extension NewsFeedVM {
    func newsListApi(callback: @escaping (ResponseType, String) -> ()) {
        let getNewsFeeds = NewsFeeds()
        VidhikBaseURL.shared.apollo.fetch(query: getNewsFeeds, cachePolicy: .returnCacheDataElseFetch) { result in
            switch result {
            case .success(let graphQLResult):
                guard let data = try? result.get().data else { return }
                print("data+++++++++++++\(data)")
                if let getNewsList = data.resultMap["getNewsFeed"] as? [String: Any] {
                    if let status = getNewsList["status"] as? Int,
                       let message = getNewsList["message"] as? String,
                       let newsData = getNewsList["data"] as? [String: Any],
                       let newsList = newsData["results"] as? [[String: Any]] {
                        for dict in newsList {
                            let newsTitle = dict["title"] as? String
                            let newsDescription = dict["description"] as? String
                            let newsUrl = dict["source_url"] as? String
                            let newsImageUrl = dict["image_url"] as? String
                            let content = dict["content"] as? String
                            let updatedNews = NewsDataModel(title: newsTitle, description: newsDescription, newURl: newsUrl, imageURL: newsImageUrl, content: content)
                            // Append the post to the posts array
                            self.newsArray.append(updatedNews)
                        }
                        if status == 200 {
                            callback(.success, message)
                        } else {
                            callback(.failure, message)
                        }
                    }
                    
                } else if let errors = graphQLResult.errors {
                    print("GraphQL errors:", errors)
                } else {
                    print("Unexpected response format")
                }
                
            case .failure(let error):
                print("Error: \(error.localizedDescription)")
                print(error.localizedDescription)
                callback(.failure, error.localizedDescription)
            }
        }
    }
}


//(["url": Optional("https://www.tagesschau.de/wirtschaft/technologie/ki-google-microsoft-risiko-aktien-tech-konzerne-zukunft-msci-usa-technologie-nasdaq-100.html"), "author": Optional("Thomas Spinnler"), "description": Optional("Künstliche Intelligenz wird Wirtschaft und Alltag immer mehr bestimmen. Dominiert wird die Entwicklung von den großen US-Technologie-Konzernen. Ist das Rennen für Europas Tech-Branche verloren? Von Thomas Spinnler."), "content": Optional("Stand: 13.05.2024 06:32 Uhr\r\nKünstliche Intelligenz wird Wirtschaft und Alltag immer mehr bestimmen. Dominiert wird die Entwicklung von den großen US-Technologie-Konzernen. Ist das Rennen für Europas… [+7628 chars]"), "title": Optional("Die riskante Dominanz der US-Tech-Konzerne"), "urlToImage": Optional("https://images.tagesschau.de/image/42c2589c-19df-4f74-875c-829f3cc02e50/AAABjYzNVTM/AAABjwnlFvA/16x9-1280/chatgpt-112.jpg"), "publishedAt": Optional("2024-05-13T04:32:21Z")])


/*Data(resultMap: ["getNewsFeed": Optional(["data": Optional(["articles": Optional([Optional(["publishedAt": Optional("2024-05-13T05:02:00Z"), "content": Optional("LA TRIBUNE - Vous dirigez l\'entreprise EMME qui porte un ambitieux projet de conversion de nickel et de cobalt pour alimenter le marché des batteries des voitures électriques. Quel a été votre parcou… [+8929 chars]"), "author": Optional("Hélène Lerivrain"), "urlToImage": Optional("https://static.latribune.fr/full_width/2368590/emme-bordeaux.jpg"), "url": Optional("https://objectifaquitaine.latribune.fr/business/2024-05-13/batteries-nous-diviserons-par-cinq-l-empreinte-des-metaux-energetiques-emme-bordeaux-997104.html"), "description": Optional("LA TRIBUNE - Vous dirigez l\'entreprise EMME qui porte un ambitieux projet de conversion de nickel et de cobalt pour alimenter le marché des batteries des voitures électriques. Quel a été votre parcours ? ANTONIN BEURRIER - Je suis un investisseur industriel. …"), "title": Optional("Batteries : « Nous diviserons par cinq l\'empreinte des métaux énergétiques » (EMME Bordeaux)")]), Optional(["title": Optional("Volkswagen: VW plant die elektrische GTI-Zukunft"), "url": Optional("https://www.mobiflip.de/shortnews/volkswagen-vw-plant-die-elektrische-gti-zukunft/"), "content": Optional("Volkswagen war Anfang 2024 fleißig und hat die restlichen GTX-Modelle für das ID-Lineup vorgestellt, selbst der Buzz bekam eine GTX-Version spendiert. Doch das Branding hat keine große Zukunft bei Vo… [+2065 chars]"), "author": Optional("Oliver Schwuchow"), "publishedAt": Optional("2024-05-13T05:00:20Z"), "urlToImage": Optional("https://www.mobiflip.de/wp-content/uploads/2023/12/volkswagen-vw-id-gti-header.jpeg"), "description": Optional("Volkswagen war Anfang 2024 fleißig und hat die restlichen GTX-Modelle für das ID-Lineup vorgestellt, selbst der Buzz bekam eine GTX-Version spendiert. Doch das Branding hat keine große Zukunft bei Volkswagen, […]")]), Optional(["title": Optional("heise+ | BMW iX2 im Test: Elektroauto mit hohem Reifegrad"), "description": Optional("Der BMW iX2 ist ein Elektroauto, das an vielen Stellen eine sehr überzeugende Vorstellung abliefert. Nur bei der DC-Ladeleistung muss BMW nachlegen."), "urlToImage": Optional("https://heise.cloudimg.io/bound/1200x1200/q85.png-lossy-85.webp-lossy-85.foil1/_www-heise-de_/imgs/18/4/5/8/8/0/9/6/XZW01-86d976de0b37013b.jpg"), "url": Optional("https://www.heise.de/tests/BMW-iX2-im-Test-Elektroauto-mit-hohem-Reifegrad-9714421.html?wt_mc=rss.red.autos.autos.atom.beitrag_plus.beitrag_plus"), "content": Optional("Inhaltsverzeichnis\r\nDer BMW iX2 polarisiert: Die einen sehen im Design des iX2 die progressive Alternative zum Tesla Model Y. Für andere ist die Formensprache bestenfalls unangepasst. Unzweifelhaft i… [+2153 chars]"), "author": Optional("Christoph M. Schwarzer"), "publishedAt": Optional("2024-05-13T05:00:00Z")]), Optional(["author": Optional("Die Presse"), "title": Optional("Optimismus lohnt sich"), "url": Optional("https://www.diepresse.com/18447264/optimismus-lohnt-sich"), "publishedAt": Optional("2024-05-13T05:00:00Z"), "description": Optional("Es kann durchaus sein, dass nun der richtige Zeitpunkt ist, etwas mehr Bargeld als sonst zu halten. Aber machen Sie es ein bisschen mehr wie die Amerikaner und glauben Sie fest daran, dass Sie an den Börsen langfristig Geld verdienen werden."), "content": Optional("Es kann durchaus sein, dass nun der richtige Zeitpunkt ist, etwas mehr Bargeld als sonst zu halten. Aber machen Sie es ein bisschen mehr wie die Amerikaner und glauben Sie fest daran, dass Sie an den… [+3948 chars]"), "urlToImage": Optional("https://img.diepresse.com/public/incoming/5s1i36-GLOBAL-MARKETSVIEW-ASIA-PIX/alternates/DPR_SOCIAL_MEINUNG/GLOBAL-MARKETSVIEW-ASIA%20PIX")]), Optional(["urlToImage": Optional("https://overclockers.ru/assets/logo_big.png"), "publishedAt": Optional("2024-05-13T04:52:00Z"), "title": Optional("Основатель XPeng лично вручил купленный основателем Nio электрический минивэн X9"), "author": Optional("Алексей Сычёв"), "description": Optional("Для него это стала первая за восемь лет машина «чужой» марки."), "url": Optional("https://overclockers.ru/hardnews/show/134033/osnovatel-xpeng-lichno-vruchil-kuplennyj-osnovatelem-nio-elektricheskij-miniven-x9"), "content": Optional(". (Elon Musk) , NVIDIA (Jensen Huang) Tesla Model X . CnEVPost « » , .\r\n , Nio (William Li, ) XPeng (He Xiaopeng, ) , XPeng X9. Nio XPeng . , 9831 . , 31,5 % XPeng .\r\nNio , , , . , XPeng 50- XPeng X9… [+175 chars]")]), Optional(["author": Optional("CHIP Online"), "description": Optional("Mercedes-Benz\'in bir parçası olan Daimler, ilk otonom kamyonunu tanıttı ve yollara çıkması için çok uzun bir süre beklemeye niyetli olmadığını açık açık söyledi."), "urlToImage": Optional("https://img.chip.com.tr/rcman/Cw1280h720q95gm/storage/files/images/2024/05/09/daimler-yeni-tamamen-elektrikli-otonom-kamyonunu-tanitti-riqb.jpg"), "publishedAt": Optional("2024-05-13T04:51:22Z"), "url": Optional("https://www.chip.com.tr/haber/surucusuz-kamyonlar-2027-yilinda-yollara-cikiyor_163476.html"), "content": Optional("Mercedes-Benz ana şirketinin bir parçası olan Daimler Truck, ilk otonom kamyon gösterimini gerçekleştirdi ve 2027 yılına kadar tamamen sürücüsüz yük taşımacılığının yolunu açacağını iddia etti.\r\nGöst… [+1819 chars]"), "title": Optional("Sürücüsüz kamyonlar, 2027 yılında yollara çıkıyor")]), Optional(["url": Optional("https://www.tagesschau.de/wirtschaft/technologie/ki-google-microsoft-risiko-aktien-tech-konzerne-zukunft-msci-usa-technologie-nasdaq-100.html"), "author": Optional("Thomas Spinnler"), "description": Optional("Künstliche Intelligenz wird Wirtschaft und Alltag immer mehr bestimmen. Dominiert wird die Entwicklung von den großen US-Technologie-Konzernen. Ist das Rennen für Europas Tech-Branche verloren? Von Thomas Spinnler."), "content": Optional("Stand: 13.05.2024 06:32 Uhr\r\nKünstliche Intelligenz wird Wirtschaft und Alltag immer mehr bestimmen. Dominiert wird die Entwicklung von den großen US-Technologie-Konzernen. Ist das Rennen für Europas… [+7628 chars]"), "title": Optional("Die riskante Dominanz der US-Tech-Konzerne"), "urlToImage": Optional("https://images.tagesschau.de/image/42c2589c-19df-4f74-875c-829f3cc02e50/AAABjYzNVTM/AAABjwnlFvA/16x9-1280/chatgpt-112.jpg"), "publishedAt": Optional("2024-05-13T04:32:21Z")]), Optional(["description": Optional("Less than a month after its reveal, the new Tesla Model 3 Performance has now made its Malaysian debut at the Tesla Experience Centre Cyberjaya. This more athletic version of the facelifted Highland model represents […]\nThe post 2024 Tesla Model 3 Performance…"), "urlToImage": Optional("https://paultan.org/image/2024/05/2024_Tesla_Model_3_Performance_Malaysia_Ext-1-1200x801.jpg"), "author": Optional("Jonathan Lee"), "content": Optional("Less than a month after its reveal, the new Tesla Model 3 Performance has now made its Malaysian debut at the Tesla Experience Centre Cyberjaya. This more athletic version of the facelifted Highland … [+2746 chars]"), "publishedAt": Optional("2024-05-13T04:22:13Z"), "title": Optional("2024 Tesla Model 3 Performance in Malaysia – 460 hp, 0-100 km/h in 3.1 secs, 528 km range, from RM244k"), "url": Optional("https://paultan.org/2024/05/13/2024-tesla-model-3-performance-in-malaysia-460-hp-0-100-km-h-in-3-1-secs-528-km-range-from-rm244k/")]), Optional(["title": Optional("EUA devem impor novas taxas contra carros elétricos chineses"), "author": Optional("Tudocelular.com"), "description": Optional("O governo dos EUA deve impor tarifas mais altas para a importação de carros elétricos chineses."), "urlToImage": Optional("https://t2.tudocdn.net/629961?w=1920"), "content": Optional("O governo dos Estados Unidos deve impor novas taxas contra a importação de carros elétricos chineses. Segundo informações divulgadas no fim de semana, o anúncio oficial da medida deve acontecer ainda… [+1693 chars]"), "publishedAt": Optional("2024-05-13T04:20:00Z"), "url": Optional("https://www.tudocelular.com/mercado/noticias/n221097/eua-devem-impor-taxas-altas-carros-chineses-.html")]), Optional(["publishedAt": Optional("2024-05-13T04:11:00Z"), "url": Optional("https://www.patronlardunyasi.com/otomobil-cok-sarj-istasyonu-yetersiz"), "author": Optional("Patronlar Dünyası"), "title": Optional("Otomobil çok şarj istasyonu yetersiz"), "urlToImage": Optional("https://image.patronlardunyasi.com/static/content/24-05/13/standart-haber-gorseli-kopyasi-26.jpg"), "content": Optional("Türkiye yollarndaki elektrikli otomobillerin says hzla artarken arj altyaps ayn oranda artmyor. AB üyesi ülkeler içerisinde trafie kaytl elektrikli araç says bakmndan 11. srada yer alan Türkiye, arj … [+2444 chars]"), "description": Optional("Türkiye’de trafiğe kayıtlı elektrikli otomobil sayısı son 1.5 yılda sıçrama yaparak yüzde 600’e yakın arttı ve 99 bin 759 adede ulaştı. Ancak, şarj noktası sayısı aynı oranda artmadı. AB üyesi ülkeler içerisinde trafiğe kayıtlı elektrikli araç sayısı bakımınd…")]), Optional(["content": Optional("Tesla Gigafactory Berlin . , , Tesla. , , .\r\n , , , Tesla . Disrupt Tesla, Tesla 800 . , , .\r\nTesla , , .\r\n Tesla , , , , . Tesla . Tesla «-».\r\n Tesla , , . Tesla 6 000 . . , .\r\n:\r\nyahoo"), "urlToImage": Optional("https://img.ixbt.site/live/topics/preview/00/07/00/44/87e34d353e.png"), "description": Optional("Продолжается обсуждение производственного комплекса Tesla Gigafactory Berlin в Германии. И вот вчера протестующие, выступающие против планов автопроизводителя по расширению производства в этом...Читать дальше"), "title": Optional("Завод Tesla в Германии атакован протестующими"), "publishedAt": Optional("2024-05-13T04:03:26Z"), "author": Optional("dima0782"), "url": Optional("https://www.ixbt.com/live/offtopic/zavod-tesla-v-germanii-atakovan-protestuyuschimi.html")]), Optional(["publishedAt": Optional("2024-05-13T04:00:00Z"), "content": Optional("p&gt;Türkiye yollarndaki elektrikli otomobillerin says hzla artarken arj altyaps ayn oranda artmyor. AB üyesi ülkeler içerisinde trafie kaytl elektrikli araç says bakmndan 11. srada yer alan Türkiye,… [+2391 chars]")]
 */
